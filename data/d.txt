123
df = pd.DataFrame({'ghi': weather["GHI"]})
df["year"] = weather["Year"]
df["month"] = weather["Month"]
df["day"] = weather["Day"]
df["hour"] = weather["Hour"]

agg = df.groupby(["month","hour"]).mean()
agg = agg.reset_index().pivot(index="month",columns="hour",values="ghi")
plt.imshow(agg)
plt.xlabel("Hour")
plt.ylabel("Month")
plt.title("12 x 24 Mean GHI (W/m^2)")
plt.colorbar()
st.pyplot(agg)
